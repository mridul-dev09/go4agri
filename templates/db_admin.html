{% extends "db_base.html" %}

{% block dashboard_title %}Admin Control Panel{% endblock %}

{% block dashboard_content %}
<div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px;">
    <div
        style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #2d5a27;">
        <p style="color: #666; font-size: 0.9rem; margin-bottom: 10px;">Ongoing Applications</p>
        <h2 style="color: #333;">{{ applications|length }}</h2>
    </div>
    <!-- ... (other stats) ... -->
</div>

<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px; margin-bottom: 40px;">
    <!-- Application Approval Queue -->
    <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.05);">
        <h3
            style="color: var(--primary-green); margin-bottom: 20px; border-bottom: 2px solid #f4f7f4; padding-bottom: 10px;">
            Pending Approvals</h3>

        {% if not applications %}
        <p style="color: #999; padding: 20px; text-align: center;">No applications awaiting your approval.</p>
        {% else %}
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="text-align: left; border-bottom: 1px solid #eee;">
                    <th style="padding: 12px; color: #666; font-weight: 600;">Company</th>
                    <th style="padding: 12px; color: #666; font-weight: 600;">Program</th>
                    <th style="padding: 12px; color: #666; font-weight: 600;">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for app in applications %}
                <tr style="border-bottom: 1px solid #f9f9f9;">
                    <td style="padding: 12px; font-size: 0.9rem;">{{ app.company_name }}</td>
                    <td style="padding: 12px; font-size: 0.9rem;">{{ app.program_type }}</td>
                    <td style="padding: 12px;">
                        <form action="/update-application-status/{{ app.id }}" method="POST">
                            <button type="submit"
                                style="background: #2d5a27; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 0.8rem;">SEND
                                TO QA</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}
    </div>

    <!-- Bulk Upload Section -->
    <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.05);">
        <h3
            style="color: var(--primary-green); margin-bottom: 20px; border-bottom: 2px solid #f4f7f4; padding-bottom: 10px;">
            Bulk Employee Upload</h3>

        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div
            style="padding: 10px; margin-bottom: 15px; border-radius: 5px; font-size: 0.85rem; background: {% if category == 'error' %}#f8d7da{% else %}#d4edda{% endif %}; color: {% if category == 'error' %}#721c24{% else %}#155724{% endif %};">
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}

        <form action="/admin/upload-employees" method="POST" enctype="multipart/form-data">
            <input type="file" name="employee_file" accept=".xlsx, .xls" required
                style="width: 100%; border: 1px solid #ddd; padding: 8px; border-radius: 5px; font-size: 0.85rem; margin-bottom: 10px;">
            <button type="submit" class="btn-gold"
                style="width: 100%; border: none; cursor: pointer; padding: 12px;">UPLOAD & SYNC</button>
        </form>
    </div>
</div>
{% endblock %}